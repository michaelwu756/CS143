\documentclass[12pt]{article}
\begin{document}
\title{Computer Science 143, Homework 2}
\date{May 1st, 2018}
\author{Michael Wu\\UID: 404751542}
\maketitle

\section*{Problem 1}

\paragraph{a)}

I ran the following query
\begin{verbatim}
SELECT highway, area, COUNT(*) AS count
FROM caltrans
WHERE text LIKE '%closed%'
  AND (text LIKE '%for the winter%'
    OR text LIKE '%due to snow%')
GROUP BY highway, area
ORDER BY count DESC
LIMIT 20;
\end{verbatim}
and got the result set shown below.
\begin{center}
        \hspace*{-4cm}
        \begin{tabular}{c|c|c}
                highway & area & count\\
                \hline
                SR120 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 316\\
                SR89  & IN THE NORTHERN CALIFORNIA AREA \& SIERRA NEVADA & 271\\
                SR203 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 224\\
                SR108 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 203\\
                SR4 & IN THE CENTRAL CALIFORNIA AREA & 200\\
                SR168 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 152\\
                SR270 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 145\\
                SR89 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 131\\
                SR2 & IN THE SOUTHERN CALIFORNIA AREA &   129\\
                SR158 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA  & 95\\
                SR172 & IN THE NORTHERN CALIFORNIA AREA & 66\\
                SR88 & IN THE CENTRAL CALIFORNIA \& SIERRA NEVADA & 17\\
                SR3 & IN THE NORTHERN CALIFORNIA AREA & 13\\
                SR130 & IN THE CENTRAL CALIFORNIA AREA & 7\\
                I5 & IN THE NORTHERN CALIFORNIA AREA & 5\\
                SR33 & IN THE SOUTHERN CALIFORNIA AREA & 4\\
                US395 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 3\\
                SR18 & IN THE SOUTHERN CALIFORNIA AREA & 2\\
                SR267 & IN THE NORTHERN CALIFORNIA AREA & 1\\
                SR138 & IN THE SOUTHERN CALIFORNIA AREA & 1
        \end{tabular}
        \hspace*{-4cm}
\end{center}

\paragraph{b)}

I ran the following query
\begin{verbatim}
SELECT a.highway, a.area, closedPct
FROM
  (SELECT highway, area, COUNT(*) AS count
   FROM caltrans
   WHERE text LIKE '%closed%'
     AND (text LIKE '%for the winter%'
       OR text LIKE '%due to snow%')
   GROUP BY highway, area
   ORDER BY count DESC
   LIMIT 20)
  AS a
JOIN
  (SELECT highway, area, count(*)*100/365 AS closedPct
   FROM
     (SELECT DATE(reported), highway, area
      FROM caltrans
      WHERE text LIKE '%closed%'
      GROUP BY highway, area, DATE(reported))
     AS closedDays
   GROUP BY highway, area)
  AS closure
ON a.highway = closure.highway
  AND a.area = closure.area
ORDER BY closedPct DESC
LIMIT 5;
\end{verbatim}
and got the folliwng result set.
\begin{center}
        \hspace*{-4cm}
        \begin{tabular}{c|c|c}
                highway & area & closedPct\\
                \hline
                SR89 & IN THE NORTHERN CALIFORNIA AREA \& SIERRA NEVADA & 66.5753\\
                SR120 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 66.5753\\
                SR4 & IN THE CENTRAL CALIFORNIA AREA & 63.5616\\
                SR203 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 61.3699\\
                SR108 & IN THE CENTRAL CALIFORNIA AREA \& SIERRA NEVADA & 55.6164
        \end{tabular}
        \hspace*{-4cm}
\end{center}

\section*{Problem 2}

\paragraph{a)}

A natural join will result in a cross join when there are no common attributes. Thus the venn diagram
should have their areas overlap. In fact, any equi join with no join key will result in a cross join,
so cross join should be a subset of equi join. The same can be said about non equi join, since that can
result in a cross join as well. Overall the relationship between different types of joins is fairly
complex and cannot be expressed in a nice form using a venn diagram, as there are too many types of joins.
Venn diagrams are usually only good if there are two sets being compared.

\section*{Problem 3}

\paragraph{a)}

\paragraph{b)}

\paragraph{c)}

\paragraph{d)}

\end{document}